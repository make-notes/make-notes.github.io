<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-服务端/Docker系统性入门+进阶实践/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Docker系统性入门+进阶实践 | My Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://make-notes.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://make-notes.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://make-notes.github.io/docs/服务端/Docker系统性入门+进阶实践/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Docker系统性入门+进阶实践 | My Site"><meta data-rh="true" name="description" content="笔记请访问文档、github"><meta data-rh="true" property="og:description" content="笔记请访问文档、github"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://make-notes.github.io/docs/服务端/Docker系统性入门+进阶实践/"><link data-rh="true" rel="alternate" href="https://make-notes.github.io/docs/服务端/Docker系统性入门+进阶实践/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://make-notes.github.io/docs/服务端/Docker系统性入门+进阶实践/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Atom Feed"><link rel="stylesheet" href="/assets/css/styles.3a700447.css">
<script src="/assets/js/runtime~main.fcf06412.js" defer="defer"></script>
<script src="/assets/js/main.091f1087.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">首页</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">英语</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/英语/裕兴新概念/">裕兴新概念</a></li><li><a class="dropdown__link" href="/docs/英语/语法关键词/">语法关键词</a></li><li><a class="dropdown__link" href="/docs/英语/董必乐英语/">董必乐英语</a></li><li><a class="dropdown__link" href="/docs/英语/老司机刘彬/">老司机刘彬</a></li><li><a class="dropdown__link" href="/docs/英语/英语兔/">英语兔</a></li><li><a class="dropdown__link" href="/docs/英语/原力英语/">原力英语</a></li><li><a class="dropdown__link" href="/docs/英语/e学苑在线教育/">e学苑在线教育</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">服务器</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/服务端/Docker系统性入门+进阶实践/">Docker 系统性入门+进阶实践</a></li><li><a class="dropdown__link" href="/docs/服务端/Linux核心技能与应用/">Linux核心技能与应用</a></li></ul></div><a class="navbar__item navbar__link" href="/blog/">博客</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/服务端/">服务端</a><button aria-label="折叠侧边栏分类 &#x27;服务端&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/服务端/Docker系统性入门+进阶实践/">Docker系统性入门+进阶实践</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/服务端/Linux核心技能与应用/">Linux 核  心技能与应用</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/英语/">英语</a><button aria-label="展开侧边栏分类 &#x27;英语&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/服务端/"><span itemprop="name">服务端</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Docker系统性入门+进阶实践</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>Docker系统性入门+进阶实践</h1>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="笔记请访问文档github">笔记请访问<a href="https://dockertips.readthedocs.io/en/latest/container-quickstart/container-vs-vm.html" target="_blank" rel="noopener noreferrer">文档</a>、<a href="https://github.com/xiaopeng163/docker.tips" target="_blank" rel="noopener noreferrer">github</a><a href="#笔记请访问文档github" class="hash-link" aria-label="笔记请访问文档github的直接链接" title="笔记请访问文档github的直接链接">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="命令">命令<a href="#命令" class="hash-link" aria-label="命令的直接链接" title="命令的直接链接">​</a></h3>
<ul>
<li>列出容器所占用得进程<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker top {容器id/名字}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>显示分层<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker history {容器id/名字}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>清除已停止的容器<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker system prune -f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>删除未使用的镜像<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker image prune -a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>-rm 执行完之后自动删除<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run {--rm nginx} ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>-f 强制删除容器，少了停止容器操作<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run {-f} ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dockerfile语法说明">dockerfile语法说明<a href="#dockerfile语法说明" class="hash-link" aria-label="dockerfile语法说明的直接链接" title="dockerfile语法说明的直接链接">​</a></h3>
<ul>
<li>FROM 拉取镜像</li>
<li>RUN 所有shell能执行的命令RUN几乎都可执行，每一行RUN命令都会产生一层image layer，导致镜像臃肿，尽量一行写完。</li>
<li>COPY 和 ADD 都可以把local文件复制到镜像，如果目标目录不存在，则自动创建。ADD相比COPY，在复制gzip等压缩文件时，ADD会自动解压文件。仅复制选择COPY，需自动解压选择ADD。</li>
<li>WORKDIR 目录切换，类似于cd命令，若目录不存在则自行创建。</li>
<li>ARG 和 ENV 在build时设置变量。ARG 可在镜像build时动态修改, 通过 --build-arg；ENV 设置的变量可以在Image中保持，并在容器中的环境变量里<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM ubuntu:20.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARG VERSION=2.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get update &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    apt-get install -y wget &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wget https://github.com/ipinfo/cli/releases/download/ipinfo-${VERSION}/ipinfo_${VERSION}_linux_amd64.tar.gz &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tar zxf ipinfo_${VERSION}_linux_amd64.tar.gz &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mv ipinfo_${VERSION}_linux_amd64 /usr/bin/ipinfo &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rm -rf ipinfo_${VERSION}_linux_amd64.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM ubuntu:20.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV VERSION=2.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get update &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    apt-get install -y wget &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wget https://github.com/ipinfo/cli/releases/download/ipinfo-${VERSION}/ipinfo_${VERSION}_linux_amd64.tar.gz &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tar zxf ipinfo_${VERSION}_linux_amd64.tar.gz &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mv ipinfo_${VERSION}_linux_amd64 /usr/bin/ipinfo &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rm -rf ipinfo_${VERSION}_linux_amd64.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ docker image build -f .\Dockerfile-arg -t ipinfo-arg-2.0.0 --build-arg VERSION=2.0.0 .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker image ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REPOSITORY         TAG       IMAGE ID       CREATED          SIZE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ipinfo-arg-2.0.0   latest    0d9c964947e2   6 seconds ago    124MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker container run -it ipinfo-arg-2.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@b64285579756:/#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@b64285579756:/# ipinfo version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@b64285579756:/#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>CMD 容  器启动命令。如果docker container run启动容器时指定了其它命令，则CMD命令会被忽略；如果定义了多个CMD，只有最后一个会被执行；</li>
<li>ENTRYPOINT 容器启动命令。与 CMD 区别，CMD 设置的命令，可以在docker container run 时传入其它命令，覆盖掉 CMD 的命令，但是 ENTRYPOINT 所设置的命令是一定会被执行的。ENTRYPOINT 和 CMD 可以联合使用，ENTRYPOINT 设置执行的命令，CMD传递参数<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM ubuntu:20.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT [&quot;echo&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD []</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>CMD和ENTRYPOINT同时支持shell格式和Exec格式<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CMD echo &quot;hello docker&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT echo &quot;hello docker&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD [&quot;echo&quot;, &quot;hello docker&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT [&quot;echo&quot;, &quot;hello docker&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>命令含有变量时shell需要指定参数<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM ubuntu:20.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV NAME=docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD echo &quot;hello $NAME&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM ubuntu:20.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV NAME=docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD [&quot;sh&quot;, &quot;-c&quot;, &quot;echo hello $NAME&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
<li>EXPOSE 对外暴露端口，不设置也可以通过-p做映射，更多起到注释作用。他人使用时知道镜像可以暴露端口对外使用。<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM python:3.9.5-slim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY app.py /src/app.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN pip install flask</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV FLASK_APP=app.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPOSE 5000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD [&quot;flask&quot;, &quot;run&quot;, &quot;-h&quot;, &quot;0.0.0.0&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>USER 指定用户</li>
<li>VOLUME 将docker中的文件路径映射到数据卷。当启动容器未设置-v参数时docker自动生成数据卷。</li>
<li>HEALLTHCHECK 健康检查，测试是否正常提供服务<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HEALLTHCHECK --interval=30s --timeout=3s \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CMD curl {url} || exit 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dockerfile实用技巧可参考官方镜像编写规范">dockerfile实用技巧，<a href="https://github.com/docker-library/official-images" target="_blank" rel="noopener noreferrer">可参考官方镜像编写规范</a><a href="#dockerfile实用技巧可参考官方镜像编写规范" class="hash-link" aria-label="dockerfile实用技巧可参考官方镜像编写规范的直接链接" title="dockerfile实用技巧可参考官方镜像编写规范的直接链接">​</a></h3>
<ul>
<li>合理使用缓存。在build时会使用缓存，从更改的分层开始不使用缓存，可以将经常变动的操作尽量放在后面，减少构建时间。</li>
<li>使用.dockerignore忽略文件，build时 build context 将过滤忽略文件。</li>
<li>镜像的多阶段构建，减少镜像大小<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM gcc:9.4 AS builder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY hello.c /src/hello.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN gcc --static -o hello hello.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM alpine:3.13.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY --from=builder /src/hello /src/hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT [ &quot;/src/hello&quot; ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># AS builder 类似于重命名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -- from 引入builder</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>尽量使用非root用户。避免通过docker做越权的事，比如通过目录映射查看无权访问的目录，或者给自己添加sudo权限。<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM python:3.9.5-slim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN pip install flask &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    groupadd -r flask &amp;&amp; useradd -r -g flask flask &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mkdir /src &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    chown -R flask:flask /src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">USER flask</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY app.py /src/app.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV FLASK_APP=app.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPOSE 5000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD [&quot;flask&quot;, &quot;run&quot;, &quot;-h&quot;, &quot;0.0.0.0&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker持久化">docker持久化<a href="#docker持久化" class="hash-link" aria-label="docker持久化的直接链接" title="docker持久化的直接链接">​</a></h3>
<ul>
<li>Data Volume, 由Docker管理，(/var/lib/docker/volumes/ Linux), 持久化数据的最好方式</li>
<li>Bind Mount，由用户指定存储的数据具体mount在系统什么位置</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker网络">docker网络<a href="#docker网络" class="hash-link" aria-label="docker网络的直接链接" title="docker网络的直接链接">​</a></h3>
<ul>
<li>系统命令<!-- -->
<ul>
<li>查看端口<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># linux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip a、ip addr、ifconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># window</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ipconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># eth0 对外通信网络</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>测试端口连通性<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">telnet {www.baidu.com 80}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>路径探测跟踪<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># linux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tracepath、traceroute</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>查看路由<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ip route</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>查看转发规则<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iptables --list -t nat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>查看端口转发信息<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -t nat -nvxL</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
<li>docker 命令<!-- -->
<ul>
<li>现有容器链接多个网络<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker network connect {网络名} {容器名}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
<li>docker 默认有bridge、host、node三个网络<br>
<img decoding="async" loading="lazy" alt="docker默认网络" src="data:image/jpeg;base64,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" width="526" height="79" class="img_ev3q">
<ul>
<li>host 网络和宿主机网络完全相同，如果容器端口指定为host则相当于宿主机监听该端口，无法在启动相同镜像因为端口已经被占。</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-compose">Docker Compose<a href="#docker-compose" class="hash-link" aria-label="Docker Compose的直接链接" title="Docker Compose的直接链接">​</a></h3>
<ul>
<li>安装docker Compose<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker install docker compose</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>docker compost语法<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">version: &quot;3.8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">services: # 容器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  servicename: # 服务名字，这个名字也是内部 bridge网络可以使用的 DNS name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    build: # 通过本地dockerfile build镜像，同时添加image参数表示设置build出来的镜像名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: # 镜像的名字</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    command: # 可选，如果设置，则会覆盖默认镜像里的 CMD命令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment: # 可选，相当于 docker run里的 --env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    volumes: # 可选，相当于docker run里的 -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    networks: # 可选，相当于 docker run里的 --network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ports: # 可选，相当于 docker run里的 -p</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    depends_on # 设置执行顺序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  servicename2:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">volumes: # 可选，相当于 docker volume create</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">networks: # 可选，相当于 docker network create</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>命令<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 启动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 在已经执行过docker-compose up且处于up状态时可以再次执行docker-compose up --build，会重新build已经更改过的镜像。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - -env-file 手动指定环境变量路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查看启动列表，需要在docker-compose.yml目录执行，否则无法找到，或者添加-f指定目录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose ps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 停止</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose stop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 构建镜像</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose build [镜像名字，表示具体build哪个，否则build全部]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 重启，当环境变量更改时需要通过此方法重启镜像使用新的值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose restart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查看环境变量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-swarm">docker swarm<a href="#docker-swarm" class="hash-link" aria-label="docker swarm的直接链接" title="docker swarm的直接链接">​</a></h3>
<ul>
<li>退出集群<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker swarm leave --force</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>创建service<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker service create {nginx:latest}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>查看service 列表<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker service ls</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>查看server详情<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker service ps {service id}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>stack启动服务，类似于docker-compose，用于swarm集群，都可以使用docker-compose.yml文件</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="提示">提示<a href="#提示" class="hash-link" aria-label="提示的直接链接" title="提示的直接链接">​</a></h3>
<ul>
<li>alpine镜像相对会小，如果需要在镜像中安装其他应用可能需要自行安装该镜像的基础服  务。</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/服务端/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">服务端</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/服务端/Linux核心技能与应用/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Linux 核心技能与应用</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#笔记请访问文档github" class="table-of-contents__link toc-highlight">笔记请访问文档、github</a></li><li><a href="#命令" class="table-of-contents__link toc-highlight">命令</a></li><li><a href="#dockerfile语法说明" class="table-of-contents__link toc-highlight">dockerfile语法说明</a></li><li><a href="#dockerfile实用技巧可参考官方镜像编写规范" class="table-of-contents__link toc-highlight">dockerfile实用技巧，可参考官方镜像编写规范</a></li><li><a href="#docker持久化" class="table-of-contents__link toc-highlight">docker持久化</a></li><li><a href="#docker网络" class="table-of-contents__link toc-highlight">docker网络</a></li><li><a href="#docker-compose" class="table-of-contents__link toc-highlight">Docker Compose</a></li><li><a href="#docker-swarm" class="table-of-contents__link toc-highlight">docker swarm</a></li><li><a href="#提示" class="table-of-contents__link toc-highlight">提示</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>